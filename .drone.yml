kind: pipeline
name: default

steps:
  - name: build
    image: golang:1.12.4-alpine3.9
    commands:
      - export GO_VERSION=$(go version)
      - "go build -ldflags \"-X main.gitVersion=${DRONE_COMMIT_SHA:0:8} -X 'main.goVersion=$GO_VERSION'\" -o drone-oss-cache ./main.go"
    environment:
      CGO_ENABLED: 0
      GOPROXY: https://athens.codework.tech

  - name: test
    image: golang:1.12.4-alpine3.9
    commands:
      - ls
      - ./drone-oss-cache